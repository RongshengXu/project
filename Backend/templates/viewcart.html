<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>HUNGRY|order</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/assets/css/common-style.css" />
    <script src="/assets/js/jquery.min.js"></script>
    <script src="/assets/js/bootstrap.min.js"></script>
    <script>
        $(document).ready(function(){
            $('button').click(function(){
                //$('#test').html("here");
                var $button = $(this);
                var oldValue = $button.parent().find("input").val();

                if ($button.text() == "+") {
                    var newVal = parseInt(oldValue) + 1;
                    //$button.parent().parent().parent().find("td:first").css({"color":"red"});
                    var n1 = $button.parent().parent().parent().find("td:first");
                    n1.css({"color":"red"});
                    $.ajax({
                        type: 'GET',
                        dataType: 'json',
                        url: '/increment',
                        data: {'dish_name': n1.text()},
                        async: true,
                        success: function(data){
                            $('#test').html(data.name);
                        },
                        error:function(exception){alert('Exeption:'+exception);}
                    });
                } else if ($button.text() == "-") {
                    if (oldValue > 0) {
                        var newVal = parseInt(oldValue) - 1;
                        //$button.parent().parent().parent().find("td:first").css({"color":"blue"});
                        var n2 = $button.parent().parent().parent().find("td:first");
                        n2.css({"color":"blue"});
                        $.ajax({
                            type: 'GET',
                            dataType: 'json',
                            url: '/decrement',
                            data: {'dish_name': n2.text()},
                            async: true,
                            success: function(data){
                                $('#test').html(data.name);
                            },
                            error:function(exception){alert('Exeption:'+exception);}
                        });
                    } else {
                        newVal = 0;
                    }
                }

                $button.parent().find("input").val(newVal);
            });
        });
    </script>
</head>
<body>
    <div class="container">
        <nav class="navbar navbar-default">
            <div class="navbar-header">
                <p class="navbar-brand">Hungry</p>
            </div>
            <div>
                <ul class="nav navbar-nav">
                    <li><a href="main">Main</a></li>
                    <li><a href="/location">Location</a></li>
                    <li><a href="/myorders">My Orders</a></li>
                    <li><a href="/servicecenter">Service Center</a></li>
                    <li><a href="/main_restaurant">Log as owner of restaurant</a></li>
                    <li><a href="/viewcart">carts</a></li>
                    <li><a href={{url}}>{{url_linktext}}</a><li></li>
                </ul>
            </div>
        </nav>
    </div>
    <div id="test"></div>
    <div class="panel-body">
        <div>
            <button style="height:25px;width:25px">-</button>
            <input type="text" value="1" style="height:25px;width:25px">
            <button id="add" style="height:25px;width:25px">+</button>
        </div>
        <table class="table">
        <thead>
          <tr>
            <th>Dish Name</th>
            <th>Price</th>
            <th>Quantity</th>
            <th></th>
          </tr>
        </thead>
            <tbody>
                {% if cart_query_len > 0%}
                    {% for item in cart_info %}
                        <!--<div class="col-md-3 col-sm-6 col-xs-12">-->
                            <!--<div class="panel panel-default">-->
                                <!--<div class="panel-footer">-->
                        <tr>
                            <td>{{item[0]}}</td>
                            <td>{{item[1]}}</td>
                            <td>
                                <div>
                                    <button style="height:25px;width:25px">-</button>
                                    <input type="text" value="{{item[2]}}" style="height:25px;width:25px">
                                    <button style="height:25px;width:25px">+</button>
                                </div>
                            </td>
                            <td><a id=""> Cancel </a></td>
                            <td hidden="hidden"></td>
                        </tr>
                    {% endfor %}
                {% else %}
                    <div style="text-align: center" class="list-group-item-heading">
                        <p>No Restaurant are available</p>
                    </div>
                {% endif %}
            </tbody>

        </table>
    </div>
</body>
<script>
    function decrement(a) {
        $.ajax$.ajax({
            type: 'GET',
            dataType: 'json',
            url: '/decrement',
            data: {'dish_name': a},
            async: false,
            success: function(data){
                var a = data;
            }
        });
    }
</script>
</html>